{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–π–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</title>
    <link rel="stylesheet" type="text/css" href="{% static 'myapp/style.css' %}">
    <link rel="stylesheet" href="{% static 'myapp/footer.css' %}">
    <link rel="stylesheet" href="{% static 'myapp/header.css' %}">
    <link rel="stylesheet" href="{% static 'myapp/teacher_form.css' %}">
    <style>


    </style>
</head>
<body>
    <header class="site-header">
    <div class="header-card">
        <a href="{% url 'teachers_list' %}" class="header-logo">
        <img src="{% static 'myapp/images/logo_header.png' %}" alt="ProMozgi" class="logo-img">
        </a>
        <div class="header-controls">
            {% if user.is_authenticated %}
                <form method="post" action="{% url 'logout' %}" style="display: inline;">
                    {% csrf_token %}
                    <a href="{% url 'my_ads' %}" class="btn-outline">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</a>
                    <button type="submit" class="btn-v">–í—ã–π—Ç–∏</button>
                </form>
            {% else %}
                <div style="display: inline;">
                <a href="{% url 'register' %}" class="btn-outline">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                <a href="{% url 'login' %}?next={{ request.path }}" class="btn-v">–í–æ–π—Ç–∏</a>
                </div>
            {% endif %}
            </div>

    </div>
    </header>      


    <a href="{% url 'my_ads' %}" class="back-button">
        ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π
    </a>
    
    <h1>–°–æ–π–¥–∞–π —Å–≤–æ—ë –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h1>
    <div class="form-container">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
             <div class="form-group">
                <label for="{{ form.fio.id_for_label }}">–§–ò–û:</label>
                {{ form.fio }}
            </div>
            
            <div class="form-group">
                <label for="{{ form.photo.id_for_label }}">–§–æ—Ç–æ:</label>
                <div class="file-input-wrapper">
                    {{ form.photo }}
                </div>
            </div>
            
            <div class="form-group">
                <label for="{{ form.description.id_for_label }}">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                {{ form.description }}
            </div>
            
            <div class="form-group">
                <label for="{{ form.price.id_for_label }}">–¶–µ–Ω–∞:</label>
                {{ form.price }}
            </div>
            
            <!-- –ü—Ä–µ–¥–º–µ—Ç—ã -->
            <div class="form-group">
                <label>–ü—Ä–µ–¥–º–µ—Ç—ã:</label>
                <div class="checkbox-container">
                    {{ form.subjects }}
                </div>
            </div>
            
            <!-- –ö–ª–∞—Å—Å—ã -->
            <div class="form-group">
                <label>–ö–ª–∞—Å—Å—ã:</label>
                <div class="checkbox-container">
                    {{ form.klass }}
                </div>
            </div>
            
            <div class="form-group">
                <label for="id_phone">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                <div class="phone-input">
                    <span>+375</span>
                    <span>(</span>
                    <input type="number" class="phone-part phone-part-2digits" id="phone-part1" min="0" max="99" placeholder="XX">
                    <span>)</span>
                    <input type="number" class="phone-part phone-part-3digits" id="phone-part2" min="0" max="999" placeholder="XXX">
                    <input type="number" class="phone-part phone-part-2digits" id="phone-part3" min="0" max="99" placeholder="XX">
                    <input type="number" class="phone-part phone-part-2digits" id="phone-part4" min="0" max="99" placeholder="XX">
                </div>
                <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ -->
                <input type="hidden" name="phone" id="phone-hidden" value="">
            </div>
            <button type="submit" class="btn-v">–°–æ–∑–¥–∞—Ç—å</button>
        </form>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
        const fileInput = document.querySelector('input[type="file"]');
        if (fileInput) {
            fileInput.addEventListener('change', function(e) {
                const fileName = e.target.files[0] ? e.target.files[0].name : '—Ñ–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω';
                document.getElementById('file-name').textContent = fileName;
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        const phoneParts = [
            document.getElementById('phone-part1'),
            document.getElementById('phone-part2'),
            document.getElementById('phone-part3'),
            document.getElementById('phone-part4')
        ];
        const phoneHidden = document.getElementById('phone-hidden');
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        const existingPhone = "{{ form.phone.value|default:'' }}";
        if (existingPhone) {
            const cleaned = existingPhone.replace(/\D/g, '');
            if (cleaned.startsWith('375') && cleaned.length >= 12) {
                phoneParts[0].value = cleaned.substring(3, 5);
                phoneParts[1].value = cleaned.substring(5, 8);
                phoneParts[2].value = cleaned.substring(8, 10);
                phoneParts[3].value = cleaned.substring(10, 12);
                updateHiddenPhone();
            }
        }
        
        function updateHiddenPhone() {
            const values = phoneParts.map(part => part.value.padStart(part.id === 'phone-part2' ? 3 : 2, '0'));
            const allFilled = values.every(val => val.length === (values.indexOf(val) === 1 ? 3 : 2));
            
            if (allFilled) {
                phoneHidden.value = `+375${values[0]}${values[1]}${values[2]}${values[3]}`;
            } else {
                phoneHidden.value = '';
            }
        }
        
        phoneParts.forEach(part => {
            part.addEventListener('input', function() {
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –≤–≤–æ–¥–∞
                if (this.id === 'phone-part2') {
                    if (this.value.length > 3) {
                        this.value = this.value.slice(0, 3);
                    }
                } else {
                    if (this.value.length > 2) {
                        this.value = this.value.slice(0, 2);
                    }
                }
                // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
                this.value = this.value.replace(/\D/g, '');
                updateHiddenPhone();
            });
            
            part.addEventListener('keydown', function(e) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, backspace, delete, —Å—Ç—Ä–µ–ª–∫–∏
                if (e.key >= '0' && e.key <= '9') return;
                if (['Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Tab'].includes(e.key)) return;
                e.preventDefault();
            });
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –ø–æ–ª—è–º–∏
        phoneParts.forEach((part, index) => {
            part.addEventListener('input', function() {
                const maxLength = this.id === 'phone-part2' ? 3 : 2;
                if (this.value.length === maxLength && index < phoneParts.length - 1) {
                    phoneParts[index + 1].focus();
                }
            });
        });
    </script>
      <footer class="site-footer">
        <div class="footer-card">
          <div class="footer-brand">
            <img src="{% static 'myapp/images/logo_footer.png' %}" alt="–õ–æ–≥–æ—Ç–∏–ø" class="footer-logo">
            <p>–ù–∞–π–¥–∏ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç</p>
          </div>

          <div class="footer-contacts">
            <p>üìß promozgi@mail.ru</p>
            <p>üìû +375 (29) 777 77 77</p>
          </div>

          <div class="footer-social">
            <a href="#" class="social-link">Telegram</a>
            <a href="#" class="social-link">VK</a>
            <a href="#" class="social-link">WhatsApp</a>
          </div>

          <div class="footer-legal">
            <p>¬© 2025 ProMozgi. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <p>
              <a href="/privacy/">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a> | 
              <a href="/terms/">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
            </p>
          </div>
        </div>
      </footer>
</body>
</html>